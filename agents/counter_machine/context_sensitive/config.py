from agents.counter_machine.machine import CounterMachine


class ContextSensitiveCounterMachine(CounterMachine):
    def __init__(self):
        super().__init__()
        self.U = [0, 1, 2]
        self.F = [3]
        self.u_0 = 0

        self.delta_u = {
            (("A",), 0, ("-", "-")): 0,
            (("E",), 0, ("-", "-")): 1,
            (("B",), 0, ("-", "-")): 3,
            (("C",), 0, ("-", "-")): 3,
            ((), 0, ("-", "-")): 0,
            (("A",), 1, ("-", "-")): 3,
            (("E",), 1, ("-", "-")): 3,
            (("B",), 1, ("NZ", "-")): 1,
            (("C",), 1, ("-", "-")): 3,
            ((), 1, ("-", "-")): 1,
            (("eps",), 1, ("Z", "-")): 2,
            (("A",), 2, ("-", "-")): 3,
            (("E",), 2, ("-", "-")): 3,
            (("B",), 2, ("-", "-")): 3,
            (("C",), 2, ("Z", "NZ")): 2,
            ((), 2, ("-", "-")): 2,
            (("eps",), 2, ("Z", "Z")): 3,
        }
        self.delta_c = {
            (("A",), 0, ("-", "-")): (1, 1),
            (("E",), 0, ("-", "-")): (0, 0),
            (("B",), 0, ("-", "-")): (0, 0),
            (("C",), 0, ("-", "-")): (0, 0),
            ((), 0, ("-", "-")): (0, 0),
            (("A",), 1, ("-", "-")): (0, 0),
            (("E",), 1, ("-", "-")): (0, 0),
            (("B",), 1, ("NZ", "-")): (-1, 0),
            (("C",), 1, ("-", "-")): (0, 0),
            ((), 1, ("-", "-")): (0, 0),
            (("eps",), 1, ("Z", "-")): (0, 0),
            (("A",), 2, ("-", "-")): (0, 0),
            (("E",), 2, ("-", "-")): (0, 0),
            (("B",), 2, ("-", "-")): (0, 0),
            (("C",), 2, ("Z", "NZ")): (0, -1),
            ((), 2, ("-", "-")): (0, 0),
            (("eps",), 2, ("Z", "Z")): (0, 0),
        }
        self.delta_r = {
            (("A",), 0, ("-", "-")): 0,
            (("E",), 0, ("-", "-")): 0,
            (("B",), 0, ("-", "-")): 0,
            (("C",), 0, ("-", "-")): 0,
            ((), 0, ("-", "-")): 0,
            (("A",), 1, ("-", "-")): 0,
            (("E",), 1, ("-", "-")): 0,
            (("B",), 1, ("NZ", "-")): 0,
            (("C",), 1, ("-", "-")): 0,
            ((), 1, ("-", "-")): 0,
            (("eps",), 1, ("Z", "-")): 0,
            (("A",), 2, ("-", "-")): 0,
            (("E",), 2, ("-", "-")): 0,
            (("B",), 2, ("-", "-")): 0,
            (("C",), 2, ("Z", "NZ")): 0,
            ((), 2, ("-", "-")): 0,
            (("eps",), 2, ("Z", "Z")): 1,
        }
        self._init_transitions()
        self._init_counterfactual_transitions()
